
import org.junit.Test;
import java.io.IOException;
import org.apache.hadoop.io.FloatWritable;
import org.apache.hadoop.io.LongWritable;
import org.apache.hadoop.io.Text;
import org.apache.hadoop.mrunit.mapreduce.MapDriver;
import org.junit.Before;
import Project_1.Q4P;

public class Q4Test {
    MapDriver<LongWritable, Text, Text, FloatWritable> mapDriver;
    
    @Before
    public void setUp(){
    	Q4P.MapForQ4 mapper = new Q4P.MapForQ4();
    	mapDriver = MapDriver.newMapDriver(mapper);
    }
    
    @Test
    public void testMapper() throws IOException{
    	String REC = "\"United States\",\"USA\",\"Labor force participation rate, female (% of female population ages 15+) (modeled ILO estimate)\",\"SL.TLF.CACT.FE.ZS\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"56.3470001220703\",\"56.1430015563965\",\"56.5509986877441\",\"56.6609992980957\",\"57.6339988708496\",\"57.8400001525879\",\"58.1749992370605\",\"58.7039985656738\",\"58.8279991149902\",\"58.9930000305176\",\"59.060001373291\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"55.8720016479492\",\n"+
    			"\"United States\",\"USA\",\"Labor force participation rate, female (% of female population ages 15+) (national estimate)\",\"SL.TLF.CACT.FE.NE.ZS\",\"37.7400016784668\",\"38.0999984741211\",\"37.9199981689453\",\"38.2999992370605\",\"38.7200012207031\",\"39.2599983215332\",\"40.2700004577637\",\"41.1199989318848\",\"41.6100006103516\",\"42.7099990844727\",\"43.3400001525879\",\"43.3600006103516\",\"43.8800010681152\",\"44.7299995422363\",\"45.6599998474121\",\"46.3499984741211\",\"47.3199996948242\",\"48.439998626709\",\"49.9599990844727\",\"50.939998626709\",\"51.4900016784668\",\"52.1100006103516\",\"52.6199989318848\",\"52.9000015258789\",\"53.5800018310547\",\"54.4599990844727\",\"55.2900009155273\",\"55.9799995422363\",\"56.5800018310547\",\"57.3899993896484\",\"57.5299987792969\",\"57.3800010681152\",\"57.8300018310547\",\"57.9199981689453\",\"58.7900009155273\",\"58.939998626709\",\"59.2599983215332\",\"59.7999992370605\",\"59.8499984741211\",\"60.0299987792969\",\"59.939998626709\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"56.7999992370605\",\n"+
    			"\"United States\",\"USA\",\"Labor force participation rate, male (% of male population ages 15+) (modeled ILO estimate)\",\"SL.TLF.CACT.MA.ZS\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"75.3030014038086\",\"74.6279983520508\",\"74.6780014038086\",\"74.3629989624023\",\"74.1149978637695\",\"74.1480026245117\",\"74.1699981689453\",\"74.2570037841797\",\"74.2649993896484\",\"74.2170028686523\",\"74.177001953125\",\"73.6350021362305\",\"73.1289978027344\",\"72.4560012817383\",\"72.2149963378906\",\"72.181999206543\",\"72.3460006713867\",\"72.1019973754883\",\"71.8830032348633\",\"70.8649978637695\",\"70.0189971923828\",\"69.4130020141602\",\"69.3870010375977\",\"69.0029983520508\",\"68.5429992675781\",\"68.4250030517578\",\"68.2839965820313\",\n"+
    			"\"United Arab Emirates\",\"ARE\",\"Labor force participation rate, female (% of female population ages 15+) (national estimate)\",\"SL.TLF.CACT.FE.NE.ZS\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"10.1499996185303\",\"\",\"\",\"\",\"\",\"15.8199996948242\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"31.3299999237061\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"37.7700004577637\",\"\",\"\",\"41.8199996948242\",\"42.0699996948242\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\n";
    	
    	mapDriver.withInput(new LongWritable(), new Text(REC));
    	
    	mapDriver.withOutput(new Text("United States SL.TLF.CACT.FE.ZS 2016"),new FloatWritable(55.872f));
    	mapDriver.withOutput(new Text("United States SL.TLF.CACT.FE.ZS 2000"),new FloatWritable(59.06f));
    	mapDriver.withOutput(new Text("United States SL.TLF.CACT.FE.NE.ZS 2016"),new FloatWritable(56.8f));
    	mapDriver.withOutput(new Text("United States SL.TLF.CACT.FE.NE.ZS 2000"),new FloatWritable(59.94f));
    	
    	mapDriver.runTest(false);
    }
}
